import axios from "axios";

class AllocationService {
  BASE_URL = process.env.BASE_URL || "{PLACEHOLDER_BASE_URL}";

  async fetchAllocation(win, aggregate, options) {
    if (this.BASE_URL.includes("PLACEHOLDER_BASE_URL")) {
      this.BASE_URL = `http://localhost:9090/model`;
    }

    const { accumulate,label, filters } = options;
    const params = {
      window: win,
      aggregate: aggregate,
      label: label,
      step: "1d",
    };
    if (typeof accumulate === "boolean") {
      params.accumulate = accumulate;
    }
    const result = await axios.get(`${this.BASE_URL}/allocation/compute`, {
      params,
    });
    // const result = {"code":200,"status":"success","data":[{"okd4-ts-3/__unallocated__":{"name":"okd4-ts-3/__unallocated__","properties":{"cluster":"okd4-ts-3"},"window":{"start":"2023-12-22T00:00:00Z","end":"2023-12-23T00:00:00Z"},"start":"2023-12-22T00:00:00Z","end":"2023-12-23T00:00:00Z","minutes":1440,"cpuCores":14.22336,"cpuCoreRequestAverage":14.22336,"cpuCoreUsageAverage":1.65914,"cpuCoreHours":341.36054,"cpuCost":12.96146,"cpuCostAdjustment":0,"cpuEfficiency":0.11665,"gpuCount":0,"gpuHours":0,"gpuCost":0,"gpuCostAdjustment":0,"networkTransferBytes":10911018407655.346,"networkReceiveBytes":12187006771759.662,"networkCost":0,"networkCrossZoneCost":0,"networkCrossRegionCost":0,"networkInternetCost":0,"networkCostAdjustment":0,"loadBalancerCost":0,"loadBalancerCostAdjustment":0,"pvBytes":73663163050.66667,"pvByteHours":1767915913216,"pvCost":16.465,"pvs":{"cluster=okd4-ts-3:name=pvc-00107369-074c-4bc8-afab-fe9bb3bffe0e":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-058839de-8f6a-4024-b734-989005e49eea":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-266accbf-d5ad-4de4-a609-d83d138fe982":{"byteHours":597268889600,"cost":5.5625,"providerID":""},"cluster=okd4-ts-3:name=pvc-33f1f5a8-f3e7-49b0-82ae-2c06f25c0d7a":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-513dc73b-8b9d-4430-9e66-fca58f46c727":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-552b7b32-41ad-4cff-a49a-688ff3fc9b12":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-55a08f74-0523-440f-8b91-3195e958b852":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-685de419-cd5b-466a-91b2-f9b845fd3235":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-685ffc03-5a2c-4259-a3a9-7d9db862df15":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-6a68b771-e767-4f5f-a47b-54dc979c54ff":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-7090ecc5-865c-47eb-9a00-696779ca390d":{"byteHours":597268889600,"cost":5.5625,"providerID":""},"cluster=okd4-ts-3:name=pvc-954b104f-c0c8-4727-a7bb-7db2697f761a":{"byteHours":334470578176,"cost":3.115,"providerID":""},"cluster=okd4-ts-3:name=pvc-98f54547-f51e-4b6c-9efe-82b028bad9f1":{"byteHours":191126044672,"cost":1.78,"providerID":""},"cluster=okd4-ts-3:name=pvc-9cb3c761-3e65-4e55-9ae6-5447cc03bcb3":{"byteHours":47781511168,"cost":0.445,"providerID":""},"cluster=okd4-ts-3:name=pvc-dcee88e4-422b-48ee-ac6b-323edff7eabf":{"byteHours":0,"cost":0,"providerID":""},"cluster=okd4-ts-3:name=pvc-e3d7773e-fb07-49a3-8b53-6d42660f58a0":{"byteHours":0,"cost":0,"providerID":""}},"pvCostAdjustment":0,"ramBytes":33933452174.2222,"ramByteRequestAverage":33933452174.22218,"ramByteUsageAverage":44371907728.13372,"ramByteHours":814402852181.3326,"ramCost":3.8591,"ramCostAdjustment":0,"ramEfficiency":1.30762,"externalCost":0,"sharedCost":0,"totalCost":33.28556,"totalEfficiency":0.38989,"proportionalAssetResourceCosts":{},"lbAllocations":null,"sharedCostBreakdown":{}},"okd4-ts-3/ahmad":{"name":"okd4-ts-3/ahmad","properties":{"cluster":"okd4-ts-3","node":"okd4-worker-worker-3","controllerKind":"deployment","namespace":"ahmad-karimi-test","namespaceLabels":{"kubernetes_io_metadata_name":"ahmad-karimi-test","pod_security_kubernetes_io_audit":"privileged","pod_security_kubernetes_io_audit_version":"v1.24","pod_security_kubernetes_io_warn":"privileged","pod_security_kubernetes_io_warn_version":"v1.24","snappcloud_io_team":"ahmad"}},"window":{"start":"2023-12-22T00:00:00Z","end":"2023-12-23T00:00:00Z"},"start":"2023-12-22T00:00:00Z","end":"2023-12-22T22:15:00Z","minutes":1335,"cpuCores":0,"cpuCoreRequestAverage":0,"cpuCoreUsageAverage":0.00047,"cpuCoreHours":0,"cpuCost":0,"cpuCostAdjustment":0,"cpuEfficiency":0,"gpuCount":0,"gpuHours":0,"gpuCost":0,"gpuCostAdjustment":0,"networkTransferBytes":3020.60903,"networkReceiveBytes":2408.45903,"networkCost":0,"networkCrossZoneCost":0,"networkCrossRegionCost":0,"networkInternetCost":0,"networkCostAdjustment":0,"loadBalancerCost":0,"loadBalancerCostAdjustment":0,"pvBytes":0,"pvByteHours":0,"pvCost":0,"pvs":null,"pvCostAdjustment":0,"ramBytes":0,"ramByteRequestAverage":0,"ramByteUsageAverage":13510846.02062,"ramByteHours":0,"ramCost":0,"ramCostAdjustment":0,"ramEfficiency":0,"externalCost":0,"sharedCost":0,"totalCost":0,"totalEfficiency":0,"proportionalAssetResourceCosts":{},"lbAllocations":null,"sharedCostBreakdown":{}},"okd4-ts-3/debman-a":{"name":"okd4-ts-3/debman-a","properties":{"cluster":"okd4-ts-3","node":"okd4-worker-worker-1","container":"nginx","controller":"nginx-deployment","controllerKind":"deployment","namespace":"debman-a","pod":"nginx-deployment-74cf4cc567-5wbvq","labels":{"app":"nginx","clusterresourceoverrides_admission_autoscaling_openshift_io_enabled":"true","enforcelimits_namespaceconfig_snappcloud_io_enabled":"true","environment":"staging","kubernetes_io_metadata_name":"debman-a","pod_security_kubernetes_io_audit":"privileged","pod_security_kubernetes_io_audit_version":"v1.24","pod_security_kubernetes_io_warn":"privileged","pod_security_kubernetes_io_warn_version":"v1.24","pod_template_hash":"74cf4cc567","snappcloud_io_project":"debman-a","snappcloud_io_team":"debman-a"},"namespaceLabels":{"clusterresourceoverrides_admission_autoscaling_openshift_io_enabled":"true","enforcelimits_namespaceconfig_snappcloud_io_enabled":"true","environment":"staging","kubernetes_io_metadata_name":"debman-a","pod_security_kubernetes_io_audit":"privileged","pod_security_kubernetes_io_audit_version":"v1.24","pod_security_kubernetes_io_warn":"privileged","pod_security_kubernetes_io_warn_version":"v1.24","snappcloud_io_project":"debman-a","snappcloud_io_team":"debman-a"}},"window":{"start":"2023-12-22T00:00:00Z","end":"2023-12-23T00:00:00Z"},"start":"2023-12-22T00:00:00Z","end":"2023-12-22T22:15:00Z","minutes":1335,"cpuCores":0.2,"cpuCoreRequestAverage":0.2,"cpuCoreUsageAverage":0,"cpuCoreHours":4.45,"cpuCost":0.16897,"cpuCostAdjustment":0,"cpuEfficiency":0,"gpuCount":0,"gpuHours":0,"gpuCost":0,"gpuCostAdjustment":0,"networkTransferBytes":1474.04488,"networkReceiveBytes":1203.30194,"networkCost":0,"networkCrossZoneCost":0,"networkCrossRegionCost":0,"networkInternetCost":0,"networkCostAdjustment":0,"loadBalancerCost":0,"loadBalancerCostAdjustment":0,"pvBytes":0,"pvByteHours":0,"pvCost":0,"pvs":null,"pvCostAdjustment":0,"ramBytes":428867584,"ramByteRequestAverage":428867584,"ramByteUsageAverage":2157969.15464,"ramByteHours":9542303744,"ramCost":0.04522,"ramCostAdjustment":0,"ramEfficiency":0.00503,"externalCost":0,"sharedCost":0,"totalCost":0.21418,"totalEfficiency":0.00106,"rawAllocationOnly":{"cpuCoreUsageMax":0,"ramByteUsageMax":2310144},"proportionalAssetResourceCosts":{},"lbAllocations":null,"sharedCostBreakdown":{}},"okd4-ts-3/snappcloud":{"name":"okd4-ts-3/snappcloud","properties":{"cluster":"okd4-ts-3"},"window":{"start":"2023-12-22T00:00:00Z","end":"2023-12-23T00:00:00Z"},"start":"2023-12-22T00:00:00Z","end":"2023-12-22T22:15:00Z","minutes":1335,"cpuCores":24.54118,"cpuCoreRequestAverage":24.54118,"cpuCoreUsageAverage":1.81967,"cpuCoreHours":546.04133,"cpuCost":20.73319,"cpuCostAdjustment":0,"cpuEfficiency":0.07415,"gpuCount":0,"gpuHours":0,"gpuCost":0,"gpuCostAdjustment":0,"networkTransferBytes":2515754929959.0054,"networkReceiveBytes":3092474705318.9717,"networkCost":0,"networkCrossZoneCost":0,"networkCrossRegionCost":0,"networkInternetCost":0,"networkCostAdjustment":0,"loadBalancerCost":0,"loadBalancerCostAdjustment":0,"pvBytes":231243879424,"pvByteHours":5145176317184,"pvCost":47.91819,"pvs":{"cluster=okd4-ts-3:name=pvc-0bacdc37-0fbb-4cec-860d-4e4f86272c75":{"byteHours":47781511168,"cost":0.445,"providerID":""},"cluster=okd4-ts-3:name=pvc-19db8615-a340-4291-b96f-6dcbef76c3f4":{"byteHours":477815111680,"cost":4.45,"providerID":""},"cluster=okd4-ts-3:name=pvc-2606f92c-1305-42f5-be40-ea58d917d2e4":{"byteHours":238907555840,"cost":2.225,"providerID":""},"cluster=okd4-ts-3:name=pvc-2d98c66e-ab27-432a-ac32-afae9ec994ab":{"byteHours":47781511168,"cost":0.445,"providerID":""},"cluster=okd4-ts-3:name=pvc-2f222a10-38b5-4aa3-a811-fd7ee55db83a":{"byteHours":477815111680,"cost":4.45,"providerID":""},"cluster=okd4-ts-3:name=pvc-33b754d7-bfea-4912-9392-a334101c4fdb":{"byteHours":191126044672,"cost":1.78,"providerID":""},"cluster=okd4-ts-3:name=pvc-3d72a04e-ab2a-41d4-9570-75fe6cf30ddd":{"byteHours":955630223360,"cost":8.9,"providerID":""},"cluster=okd4-ts-3:name=pvc-639e4e78-7162-4eb0-a94f-7623970d8862":{"byteHours":238907555840,"cost":2.225,"providerID":""},"cluster=okd4-ts-3:name=pvc-6dbe9830-617f-40c2-8cc9-a785af12413f":{"byteHours":23890755584,"cost":0.2225,"providerID":""},"cluster=okd4-ts-3:name=pvc-7845204c-b56e-4dc7-a291-b629259ad25a":{"byteHours":11945377792,"cost":0.11125000000000002,"providerID":""},"cluster=okd4-ts-3:name=pvc-7a11cc3f-1d81-4998-ac82-8176075ea4f3":{"byteHours":47781511168,"cost":0.445,"providerID":""},"cluster=okd4-ts-3:name=pvc-8e24983e-8394-4400-beaf-716c34fe0985":{"byteHours":238907555840,"cost":2.225,"providerID":""},"cluster=okd4-ts-3:name=pvc-92d1ce27-c6a2-4293-bb77-b5f4b6a877ce":{"byteHours":44500000000,"cost":0.41443854570388794,"providerID":""},"cluster=okd4-ts-3:name=pvc-9a1c2112-6de9-4a8b-8923-d5f4c815835f":{"byteHours":477815111680,"cost":4.45,"providerID":""},"cluster=okd4-ts-3:name=pvc-9e80d6c0-7c54-48c3-9a7b-f23b7e276cd1":{"byteHours":191126044672,"cost":1.78,"providerID":""},"cluster=okd4-ts-3:name=pvc-c1825473-2be1-42dc-964c-90c23fbe2ac2":{"byteHours":238907555840,"cost":2.225,"providerID":""},"cluster=okd4-ts-3:name=pvc-c5b394b7-88d1-4f09-844c-cc83849c4638":{"byteHours":238907555840,"cost":2.225,"providerID":""},"cluster=okd4-ts-3:name=pvc-cb169607-fcf0-4eb5-b6d3-315486b54eca":{"byteHours":191126044672,"cost":1.78,"providerID":""},"cluster=okd4-ts-3:name=pvc-d903c3ab-2f87-4b65-9d77-ebf06727fb8d":{"byteHours":477815111680,"cost":4.45,"providerID":""},"cluster=okd4-ts-3:name=pvc-df9284d9-ffd4-4c8a-af61-b2e4b9947847":{"byteHours":47781511168,"cost":0.445,"providerID":""},"cluster=okd4-ts-3:name=pvc-e06cc708-df0c-442a-a614-9ec3d4b4803c":{"byteHours":238907555840,"cost":2.225,"providerID":""}},"pvCostAdjustment":0,"ramBytes":34836786175.5206,"ramByteRequestAverage":34836786175.52061,"ramByteUsageAverage":28219906131.64882,"ramByteHours":775118492405.3333,"ramCost":3.67295,"ramCostAdjustment":0,"ramEfficiency":0.81006,"externalCost":0,"sharedCost":0,"totalCost":72.32433,"totalEfficiency":0.1849,"proportionalAssetResourceCosts":{},"lbAllocations":null,"sharedCostBreakdown":{}},"okd4-ts-3/test-a":{"name":"okd4-ts-3/test-a","properties":{"cluster":"okd4-ts-3","container":"nginx","controller":"nginx-deployment","controllerKind":"deployment","namespace":"test-a","namespaceLabels":{"clusterresourceoverrides_admission_autoscaling_openshift_io_enabled":"true","enforcelimits_namespaceconfig_snappcloud_io_enabled":"true","environment":"staging","kubernetes_io_metadata_name":"test-a","pod_security_kubernetes_io_audit":"privileged","pod_security_kubernetes_io_audit_version":"v1.24","pod_security_kubernetes_io_warn":"privileged","pod_security_kubernetes_io_warn_version":"v1.24","snappcloud_io_project":"test-a","snappcloud_io_team":"test-a"}},"window":{"start":"2023-12-22T00:00:00Z","end":"2023-12-23T00:00:00Z"},"start":"2023-12-22T00:00:00Z","end":"2023-12-22T22:15:00Z","minutes":1335,"cpuCores":0.2,"cpuCoreRequestAverage":0.2,"cpuCoreUsageAverage":0,"cpuCoreHours":4.45,"cpuCost":0.16897,"cpuCostAdjustment":0,"cpuEfficiency":0,"gpuCount":0,"gpuHours":0,"gpuCost":0,"gpuCostAdjustment":0,"networkTransferBytes":2946.27049,"networkReceiveBytes":2405.11877,"networkCost":0,"networkCrossZoneCost":0,"networkCrossRegionCost":0,"networkInternetCost":0,"networkCostAdjustment":0,"loadBalancerCost":0,"loadBalancerCostAdjustment":0,"pvBytes":0,"pvByteHours":0,"pvCost":0,"pvs":null,"pvCostAdjustment":0,"ramBytes":427819008,"ramByteRequestAverage":427819008,"ramByteUsageAverage":5115053.29231,"ramByteHours":9518972928,"ramCost":0.04511,"ramCostAdjustment":0,"ramEfficiency":0.01196,"externalCost":0,"sharedCost":0,"totalCost":0.21407,"totalEfficiency":0.00252,"proportionalAssetResourceCosts":{},"lbAllocations":null,"sharedCostBreakdown":{}}}]};
    // console.log( 'result',result.data[0]);
    return result.data;
  }
}

export default new AllocationService();
